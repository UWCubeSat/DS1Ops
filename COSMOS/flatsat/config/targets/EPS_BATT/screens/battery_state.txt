SCREEN AUTO AUTO 1.0

  TITLE "Battery State"

  VERTICAL
    
    SECTIONHEADER "Packet Data"

    LABELVALUE EPS_BATT SENSORDAT RECEIVED_TIMEFORMATTED WITH_UNITS 25  # COSMOS Received Time (Local time zone, Formatted string)
    LABELVALUE EPS_BATT SENSORDAT RECEIVED_COUNT # COSMOS packet received count

    SPACER 0 15
    
    SECTIONHEADER "Coulomb Counter" 

    VERTICALBOX
    #breakdown of the control register state
    LABEL "Control Register:"
    HORIZONTAL
      LABELVALUE EPS_BATT GENERAL ADCMODE
      LABELVALUE EPS_BATT GENERAL PRESCALER
    END
    HORIZONTAL
      LABELVALUE EPS_BATT GENERAL ALCCPIN
      LABELVALUE EPS_BATT GENERAL ANALOGSECTION
    END
    END
    SETTING BACKCOLOR 163 185 163

    #breakdown of the control register state
    VERTICALBOX
    LABEL "Status Register:"
    HORIZONTAL
      LABELVALUE EPS_BATT GENERAL UNDERVOLTAGELOCKOUT
      LABEL "The rest of the status register is not in use."
    END
    END
    SETTING BACKCOLOR 163 185 163
    
    #Main data from coulomb counter
    LABELVALUELIMITSBAR EPS_BATT SENSORDAT BATTERYVOLT WITH_UNITS
    LABELVALUELIMITSBAR EPS_BATT SENSORDAT BATTERYCURR WITH_UNITS
    LABELVALUELIMITSBAR EPS_BATT SENSORDAT BATTERYCHARGE WITH_UNITS
    
    #state of charge conversions based the raw acccharge from coulomb counter
    HORIZONTAL
      LABEL "SOC:"
      VALUE EPS_BATT SENSORDAT STATEOFCHARGE WITH_UNITS
    END
    HORIZONTAL
      LABEL "Raw mAh:"
      VALUE EPS_BATT SENSORDAT ACCCHARGE WITH_UNITS
    END

    END
    
    SPACER 0 15

    SECTIONHEADER "INA219 Node monitor"
    
    #Main data from INA
    LABELVALUELIMITSBAR EPS_BATT SENSORDAT BATTERYNODEVOLT WITH_UNITS
    LABELVALUELIMITSBAR EPS_BATT SENSORDAT BATTERYNODECURR WITH_UNITS
    LABELVALUELIMITSBAR EPS_BATT SENSORDAT BATTERYDIFFERENCE WITH_UNITS #derived difference from batterynodevolt and batteryvolt
    
    SPACER 0 15

    #Temp sensor data
    LABELVALUELIMITSBAR EPS_BATT SENSORDAT BATTERYTEMP WITH_UNITS
    
    SPACER 0 15

    # switch states and controls
    MATRIXBYCOLUMNS 3 2
      
      LABEL ""
      LABEL "Heater Switch"
      LABEL "Battery Balancer"

      LABEL "Last CMD:"
      VALUE EPS_BATT GENERAL LASTBATTHEATERCMD
      VALUE EPS_BATT GENERAL LASTBATTBALCMD

      LABEL "State:"
      VALUE EPS_BATT SENSORDAT HEATSTATE
      VALUE EPS_BATT SENSORDAT BALANCESTATE

      LABEL ""      
      BUTTON 'Enable' 'cmd("EPS_BATT BATTMGMT with BATTHEATERCMD ENABLE")'
      BUTTON 'Enable' 'cmd("EPS_BATT BATTMGMT with BATTBALANCERCMD ENABLE")'

      LABEL ""
      BUTTON 'Disable' 'cmd("EPS_BATT BATTMGMT with BATTHEATERCMD DISABLE")'
      BUTTON 'Disable' 'cmd("EPS_BATT BATTMGMT with BATTBALANCERCMD DISABLE")'

    END


      
      
